<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Download and Read OpenStreetMap Data Extracts • osmextract</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Download and Read OpenStreetMap Data Extracts">
<meta property="og:description" content="This package is used to download, convert and read Open Street
    Map data extracts downloaded from several providers. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">osmextract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/osmextract.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/providers.html">Add new OpenStreetMap providers</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itsleeds/osmextract/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="osmextract" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#osmextract" class="anchor"></a>osmextract</h1></div>
<!-- badges: start -->

<p>The goal of <code>osmextract</code> is to make it easier for people to access OpenStreetMap (OSM) data for reproducible research. OSM data is the premier source of freely available, community created geographic data worldwide. We aim to enable you to extract it for data-driven work in the public interest.</p>
<p><code>osmextract</code> downloads, converts and imports bulk OSM data hosted by providers such as <a href="http://download.geofabrik.de">Geofabrik GmbH</a> and <a href="https://download.bbbike.org/osm/">bbbike</a>. For information on alternatives and how to add them see the <a href="https://itsleeds.github.io/osmextract/articles/providers.html">providers vignette</a>.</p>
<div id="why-osmextract" class="section level2">
<h2 class="hasAnchor">
<a href="#why-osmextract" class="anchor"></a>Why osmextract?</h2>
<p>The package answers a common question for researchers who use OSM data: how to get it into a statistical environment, in an appropriate format, as part of a computationally efficient and reproducible workflow? Other packages answer parts of this question. <a href="https://github.com/ropensci/osmdata"><code>osmdata</code></a>, for example, is an R package that provides an R interface to the <a href="https://wiki.openstreetmap.org/wiki/Overpass_API">Overpass API</a>, which is ideal for downloading small OSM datasets. However, the API is rate limited, making it hard to download large datasets. As a case study, try to download all cycleways in England using <code>osmdata</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">osmdata</span>)
<span class="kw">cycleways_england</span> <span class="op">=</span> <span class="fu">opq</span>(<span class="st">"England"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">add_osm_feature</span>(key = <span class="st">"highway"</span>, value = <span class="st">"cycleway"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">osmdata_sf</span>()
<span class="co"># Error in check_for_error(doc) : General overpass server error; returned:</span>
<span class="co"># The data included in this document is from www.openstreetmap.org. The data is made available under ODbL. runtime error: Query timed out in "query" at line 4 after 26 seconds. </span>
</pre></div>
<p>The query stops with an error message after around 10 seconds. The same query can be made with <code>osmextract</code> as follows, which reads-in almost 100k linestrings in less than 10 seconds (after the data has been downloaded in the compressed <code>.pbf</code> format and converted to the open standard <code>.gpkg</code> format, not evaluated):</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/itsleeds/osmextract">osmextract</a></span>)
<span class="co">#&gt; Data (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright</span>
<span class="co">#&gt; Geofabrik data are taken from https://download.geofabrik.de/</span>
<span class="co">#&gt; For usage details of bbbike data see https://download.bbbike.org/osm/</span>
</pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">cycleways_england</span> <span class="op">=</span> <span class="fu"><a href="reference/oe_get.html">oe_get</a></span>(
  <span class="st">"England"</span>,
  quiet = <span class="fl">FALSE</span>,
  query = <span class="st">"SELECT * FROM 'lines' WHERE highway = 'cycleway'"</span>
)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_geometry.html">st_geometry</a></span>(<span class="kw">cycleways_england</span>))
</pre></div>
<p><img src="https://user-images.githubusercontent.com/1825120/87085554-f77e8b00-c227-11ea-914a-936b8be23132.png" width="100%"></p>
<p>The package is designed to complement <code>osmdata</code>, which has advantages over <code>osmextract</code> for small datasets: <code>osmdata</code> is likely to be quicker for datasets less than a few MB in size, provides up-to-date data and has an intuitive interface. <code>osmdata</code> can provide data in a range of formats, while <code>osmextract</code> only returns <a href="https://github.com/r-spatial/sf"><code>sf</code></a> objects.</p>
<p><code>osmextract</code>’s niche is that it provides a fast way to download large OSM datasets in the highly compressed <code>pbf</code> format and read them in via the fast C library <a href="https://gdal.org/drivers/vector/osm.html">GDAL</a> and the popular R package for working with geographic data, <a href="https://github.com/r-spatial/sf"><code>sf</code></a>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<!-- You can install the released version of osmextract from [CRAN](https://CRAN.R-project.org) with: -->
<!-- ``` r -->
<!-- install.packages("osmextract") -->
<!-- ``` -->
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># install.packages("remotes")</span>
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"ITSLeeds/osmextract"</span>)
</pre></div>
<p>Load the package with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/itsleeds/osmextract">osmextract</a></span>)
</pre></div>
<p>To use alongside functionality in the <code>sf</code> package we also recommend attaching this geographic data package as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://r-spatial.github.io/sf">sf</a></span>)
<span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 7.0.0</span>
</pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>Give <code>osmextract</code> a place name and it will try to find it in a list of names in the specified provider (Geofabrik by default). If the name you give it matches a place, it will download and import the associated data into R. The function <code><a href="reference/oe_get.html">oe_get()</a></code> downloads (if not already downloaded) and reads-in data from OSM extract providers as an <code>sf</code> object. By default <code><a href="reference/oe_get.html">oe_get()</a></code> imports the ‘lines’ layer, but any layer can be read-in by changing the <code>layer</code> argument:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">osm_lines</span> <span class="op">=</span> <span class="fu"><a href="reference/oe_get.html">oe_get</a></span>(<span class="st">"Isle of Wight"</span>)
<span class="kw">osm_points</span> <span class="op">=</span> <span class="fu"><a href="reference/oe_get.html">oe_get</a></span>(<span class="st">"Isle of Wight"</span>, layer = <span class="st">"points"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">osm_lines</span>)
<span class="co">#&gt; [1] 44424</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">osm_points</span>)
<span class="co">#&gt; [1] 58971</span>
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">osm_lines</span><span class="op">$</span><span class="kw">geometry</span>, xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.59</span>, <span class="op">-</span><span class="fl">1.1</span>), ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">50.5</span>, <span class="fl">50.8</span>))
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">osm_points</span><span class="op">$</span><span class="kw">geometry</span>, xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">1.59</span>, <span class="op">-</span><span class="fl">1.1</span>), ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">50.5</span>, <span class="fl">50.8</span>))
</pre></div>
<p><img src="reference/figures/README-points-lines-iow-1.png" width="50%"><img src="reference/figures/README-points-lines-iow-2.png" width="50%"></p>
<p>The figures above give an insight into the volume and richness of data contained in OSM extracts. Even for a small island such as the Isle of Wight, it contains over 100k features including ferry routes, shops and roads. The column names in the <code>osm_lines</code> object are as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">osm_lines</span>) <span class="co"># default variable names</span>
<span class="co">#&gt;  [1] "osm_id"     "name"       "highway"    "waterway"   "aerialway" </span>
<span class="co">#&gt;  [6] "barrier"    "man_made"   "z_order"    "other_tags" "geometry"</span>
</pre></div>
<p>Once imported, you can use all the functions for data frames in base R and other packages. We can also use functions from the <code>sf</code> package for spatial analysis and visualisation. Let’s plot all the major, secondary and residential roads, for example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"primary"</span>, <span class="st">"secondary"</span>, <span class="st">"residential"</span>, <span class="st">"tertiary"</span>) <span class="co"># highway types of interest</span>
<span class="kw">osm_major_roads</span> <span class="op">=</span> <span class="kw">osm_lines</span>[<span class="kw">osm_lines</span><span class="op">$</span><span class="kw">highway</span> <span class="op">%in%</span> <span class="kw">ht</span>, ]
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">osm_major_roads</span>[<span class="st">"highway"</span>], key.pos = <span class="fl">1</span>)
</pre></div>
<p><img src="reference/figures/README-iow1-1.png" width="100%"></p>
<p>The same steps can be used to get other OSM datasets (note use of <code>quiet = FALSE</code> to show additional message, examples not run):</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">test_malta</span> <span class="op">=</span> <span class="fu"><a href="reference/oe_get.html">oe_get</a></span>(<span class="st">"Malta"</span>, quiet = <span class="fl">FALSE</span>)
<span class="kw">test_andorra</span> <span class="op">=</span> <span class="fu"><a href="reference/oe_get.html">oe_get</a></span>(<span class="st">"Andorra"</span>, extra_attributes = <span class="st">"ref"</span>, quiet = <span class="fl">FALSE</span>)
</pre></div>
<p>For further details on using the package, see the <a href="https://itsleeds.github.io/osmextract/articles/osmextract.html">Introducing osmextract vignette</a>.</p>
</div>
<div id="next-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next steps</h2>
<p>We hope to make the user interface to the SQL syntax more user friendly. We would love to see more providers added (see the <a href="https://itsleeds.github.io/osmextract/articles/providers.html">Add new OpenStreetMap providers</a> for details) and see what people can do with OSM datasets of the type provided by this package in a reproducible and open statistical programming environment for the greater good. Any contributions to support this or any other improvements to the package are very welcome via our issue tracker.</p>
</div>
<div id="licence" class="section level2">
<h2 class="hasAnchor">
<a href="#licence" class="anchor"></a>Licence</h2>
<p>We hope this package will provide easy access to OSM data for reproducible research in the public interest, adhering to the condition of the <a href="https://opendatacommons.org/licenses/odbl/">OdBL licence</a> which states that</p>
<blockquote>
<p>Any Derivative Database that You Publicly Use must be only under the terms of:</p>
</blockquote>
<ul>
<li><ol>
<li>This License;</li>
</ol></li>
<li><ol>
<li>A later version of this License similar in spirit to this</li>
</ol></li>
</ul>
</div>
<div id="other-approaches" class="section level2">
<h2 class="hasAnchor">
<a href="#other-approaches" class="anchor"></a>Other approaches</h2>
<!-- todo: add links to other packages -->
<ul>
<li>
<a href="https://github.com/ropensci/osmdata">osmdata</a> is an R package for importing small datasets directly from OSM servers</li>
<li>
<a href="https://pyrosm.readthedocs.io/en/latest/">pyrosm</a> is a Python package for reading .pbf files</li>
<li>
<a href="https://github.com/pszufe/OpenStreetMapX.jl">OpenStreetMapX.jl</a> is a Julia package for reading and analysing .osm files</li>
<li>
<a href="https://www.bostongis.com/PrinterFriendly.aspx?content_name=loading_osm_postgis">PostGIS</a> is an established spatial database that works well with large OSM datasets</li>
<li>Any others? Let us know!</li>
</ul>
<!-- :) -->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/itsleeds/osmextract/">https://​github.com/​itsleeds/​osmextract/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/itsleeds/osmextract/issues">https://​github.com/​itsleeds/​osmextract/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Andrea Gilardi <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9424-7439" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Lovelace <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-5679-6536" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/itsleeds/osmextract/actions"><img src="https://github.com/itsleeds/osmextract/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/itsleeds/osmextract?branch=master"><img src="https://codecov.io/gh/itsleeds/osmextract/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Andrea Gilardi, Robin Lovelace.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
