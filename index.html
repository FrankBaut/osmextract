<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Download and Read OpenStreetMap Data Extracts • osmextractr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Download and Read OpenStreetMap Data Extracts">
<meta property="og:description" content="More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">osmextractr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/itsleeds/osmextractr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="osmextractr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#osmextractr" class="anchor"></a>osmextractr</h1></div>
<!-- badges: start -->

<p>The goal of <code>osmextractr</code> is to make it easier for R users to access freely available, community created geographic data, in the form of OpenSteetMap data extracted by providers such as <a href="http://download.geofabrik.de">Geofabrik GmbH</a>.</p>
<div id="why-osmextractr" class="section level2">
<h2 class="hasAnchor">
<a href="#why-osmextractr" class="anchor"></a>Why osmextractr?</h2>
<p><a href="https://github.com/ropensci/osmdata"><code>osmdata</code></a> provides an R interface to the <a href="https://wiki.openstreetmap.org/wiki/Overpass_API">Overpass API</a>, which is ideal for downloading small OSM datasets. However, the API is rate limited, making it hard to download large datasets. As a case study, let’s try to download all cycleways in England:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">osmdata</span>)
<span class="kw">cycleways_england</span> <span class="op">=</span> <span class="fu">opq</span>(<span class="st">"England"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">add_osm_feature</span>(key = <span class="st">"highway"</span>, value = <span class="st">"cycleway"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">osmdata_sf</span>()
<span class="co"># Error in check_for_error(doc) : General overpass server error; returned:</span>
<span class="co"># The data included in this document is from www.openstreetmap.org. The data is made available under ODbL. runtime error: Query timed out in "query" at line 4 after 26 seconds. </span>
</pre></div>
<p>The query hanged with an error message after around 10 seconds. The same query can be made with <code>osmextractr</code> as follows, which reads-in almost 100k linestrings in less than 10 seconds (after the data has been downloaded in the compressed <code>.pbf</code> format and converted to the open standard <code>.gpkg</code> format, not evaluated):</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/itsleeds/osmextractr">osmextractr</a></span>)
<span class="co">#&gt; Data (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright</span>
<span class="co">#&gt; Geofabrik data are taken from https://download.geofabrik.de/</span>
</pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">cycleways_england</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(
  <span class="st">"England"</span>,
  osmext_verbose = <span class="fl">TRUE</span>,
  query = <span class="st">"SELECT * FROM 'lines' WHERE highway = 'cycleway'"</span>
)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_geometry.html">st_geometry</a></span>(<span class="kw">cycleways_england</span>))
</pre></div>
<p><img src="https://user-images.githubusercontent.com/1825120/87085554-f77e8b00-c227-11ea-914a-936b8be23132.png" width="100%"></p>
<p>The package is designed to complement <code>osmdata</code> which has advantages over <code>osmextractr</code> for small datasets: <code>osmdata</code> is likely to be quicker for datasets less than ~10 MB, provides up-to-date data and has an intuitive interface. <code>osmdata</code> can provide data in a range of formats, while <code>osmextractr</code> only returns <a href="https://github.com/r-spatial/sf"><code>sf</code></a> objects. On the other hand, <code>osmextractr</code> provides a fast way to download large OSM datasets in the highly compressed <code>pbf</code> format and read them in via the fast C library <a href="https://gdal.org/drivers/vector/osm.html">GDAL</a> and the R package <a href="https://github.com/r-spatial/sf"><code>sf</code></a>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<!-- You can install the released version of osmextractr from [CRAN](https://CRAN.R-project.org) with: -->
<!-- ``` r -->
<!-- install.packages("osmextractr") -->
<!-- ``` -->
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># install.packages("devtools")</span>
<span class="kw">devtools</span>::<span class="fu">install_github</span>(<span class="st">"ITSLeeds/osmextractr"</span>)
</pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Give <code>osmextractr</code> the name of a geofabrik zone and it will download and import it. By default it imports the ‘lines’ layer, but any layer can be read-in. Behind the scenes, the function <code>read_pbf()</code>, a wrapper around <code><a href="https://rdrr.io/pkg/sf/man/st_read.html">sf::st_read()</a></code> is used with configuration options to import additional columns from the <code>.pbf</code> files not imported by default, including <code>maxspeed</code>, <code>lanes</code> and <code>oneway</code> (the attributes to include can be set with <code>attributes</code> argument):</p>
<p>The leitmotif of package is to help the users to read and download extracts of OpenStreetMap data stored by several providers, such as <a href="http://download.geofabrik.de/">Geofabrik</a> or <a href="https://download.bbbike.org/osm/bbbike/">bbbike</a>. The provider’s data are stored using <code>sf</code> objects that summarize the most important characteristics of each geographic zone, such as the name and the url of the pbf file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://r-spatial.github.io/sf">sf</a></span>)
<span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 7.0.0</span>
<span class="kw">osmextractr</span>::<span class="kw"><a href="reference/geofabrik_zones.html">geofabrik_zones</a></span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">8</span>)]
<span class="co">#&gt; Simple feature collection with 430 features and 2 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -180 ymin: -90 xmax: 180 ymax: 85.04177</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;           name</span>
<span class="co">#&gt; 1  Afghanistan</span>
<span class="co">#&gt; 2       Africa</span>
<span class="co">#&gt; 3      Albania</span>
<span class="co">#&gt; 4      Alberta</span>
<span class="co">#&gt; 5      Algeria</span>
<span class="co">#&gt; 6         Alps</span>
<span class="co">#&gt; 7       Alsace</span>
<span class="co">#&gt; 8      Andorra</span>
<span class="co">#&gt; 9       Angola</span>
<span class="co">#&gt; 10  Antarctica</span>
<span class="co">#&gt;                                                                          pbf</span>
<span class="co">#&gt; 1              https://download.geofabrik.de/asia/afghanistan-latest.osm.pbf</span>
<span class="co">#&gt; 2                        https://download.geofabrik.de/africa-latest.osm.pbf</span>
<span class="co">#&gt; 3                https://download.geofabrik.de/europe/albania-latest.osm.pbf</span>
<span class="co">#&gt; 4  https://download.geofabrik.de/north-america/canada/alberta-latest.osm.pbf</span>
<span class="co">#&gt; 5                https://download.geofabrik.de/africa/algeria-latest.osm.pbf</span>
<span class="co">#&gt; 6                   https://download.geofabrik.de/europe/alps-latest.osm.pbf</span>
<span class="co">#&gt; 7          https://download.geofabrik.de/europe/france/alsace-latest.osm.pbf</span>
<span class="co">#&gt; 8                https://download.geofabrik.de/europe/andorra-latest.osm.pbf</span>
<span class="co">#&gt; 9                 https://download.geofabrik.de/africa/angola-latest.osm.pbf</span>
<span class="co">#&gt; 10                   https://download.geofabrik.de/antarctica-latest.osm.pbf</span>
<span class="co">#&gt;                          geometry</span>
<span class="co">#&gt; 1  MULTIPOLYGON (((62.47808 29...</span>
<span class="co">#&gt; 2  MULTIPOLYGON (((11.60092 33...</span>
<span class="co">#&gt; 3  MULTIPOLYGON (((19.37748 42...</span>
<span class="co">#&gt; 4  MULTIPOLYGON (((-110.0051 4...</span>
<span class="co">#&gt; 5  MULTIPOLYGON (((6.899245 37...</span>
<span class="co">#&gt; 6  MULTIPOLYGON (((5.57178 48....</span>
<span class="co">#&gt; 7  MULTIPOLYGON (((8.236555 48...</span>
<span class="co">#&gt; 8  MULTIPOLYGON (((1.516233 42...</span>
<span class="co">#&gt; 9  MULTIPOLYGON (((20.72182 -1...</span>
<span class="co">#&gt; 10 MULTIPOLYGON (((-180 -90, 1...</span>
</pre></div>
</div>
<div id="load-package" class="section level2">
<h2 class="hasAnchor">
<a href="#load-package" class="anchor"></a>Load package</h2>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/itsleeds/osmextractr">osmextractr</a></span>)
</pre></div>
<p>The packages is composed by 4 main functions:</p>
<ol>
<li>
<code>osmext_match</code>: Match the input zone with one of the files stored by the OSM providers</li>
<li>
<code>osmext_download</code>: Download the chosen file</li>
<li>
<code>osmext_vectortranslate</code>: Convert the pbf format into gpkg</li>
<li>
<code>osmext_read</code>: Read the gpkg file</li>
</ol>
<p>The function <code>osmext_get</code> is a wrapper around all of them.</p>
</div>
</div>
<div id="test-osmext_match" class="section level1">
<h1 class="hasAnchor">
<a href="#test-osmext_match" class="anchor"></a>Test <code>osmext_match</code>
</h1>
<p>The simplest example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Italy"</span>)
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/europe/italy-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 1544340778</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Isle of wight"</span>)
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/europe/great-britain/england/isle-of-wight-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 6877468</span>
</pre></div>
<p>There are several situations where it could be difficult to find the appropriate data source due to several small differences in the official names:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Korea"</span>)
<span class="co">#&gt; Error: String distance between best match and the input place is 3, while the maximum threshold distance is equal to 1. You should increase the max_string_dist parameter, look for a closer match in the chosen provider database or consider using a different match_by variable.</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Russia"</span>)
<span class="co">#&gt; Error: String distance between best match and the input place is 3, while the maximum threshold distance is equal to 1. You should increase the max_string_dist parameter, look for a closer match in the chosen provider database or consider using a different match_by variable.</span>
</pre></div>
<p>For these reasons we implemented the possibility to look for the appropriate area according to the <a href="https://it.wikipedia.org/wiki/ISO_3166-1_alpha-2">iso3166-1 alpha2</a> code:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"KP"</span>, match_by = <span class="st">"iso3166_1_alpha2"</span>)
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/asia/north-korea-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 33241783</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"RU"</span>, match_by = <span class="st">"iso3166_1_alpha2"</span>)
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/russia-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 2820253009</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"US"</span>, match_by = <span class="st">"iso3166_1_alpha2"</span>)
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/north-america/us-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 6982945396</span>
</pre></div>
<p>The are a few cases where the <code>iso3166-1 alpha2</code> codes can fail because there are no per-country extracts (e.g. Israel and Palestine)</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"PS"</span>, match_by = <span class="st">"iso3166_1_alpha2"</span>)
<span class="co">#&gt; Error: String distance between best match and the input place is 1, while the maximum threshold distance is equal to 0. You should increase the max_string_dist parameter, look for a closer match in the chosen provider database or consider using a different match_by variable.</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"IL"</span>, match_by = <span class="st">"iso3166_1_alpha2"</span>)
<span class="co">#&gt; Error: String distance between best match and the input place is 1, while the maximum threshold distance is equal to 0. You should increase the max_string_dist parameter, look for a closer match in the chosen provider database or consider using a different match_by variable.</span>
</pre></div>
<p>For this reason we also created a function that let you explore the matching variables according to a chosen pattern, for example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"London"</span>)
<span class="co">#&gt; [1] "Greater London"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"Russia"</span>)
<span class="co">#&gt; [1] "Russian Federation"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"Korea"</span>)
<span class="co">#&gt; [1] "North Korea" "South Korea"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"Yorkshire"</span>)
<span class="co">#&gt; [1] "East Yorkshire with Hull" "North Yorkshire"         </span>
<span class="co">#&gt; [3] "South Yorkshire"          "West Yorkshire"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"US"</span>)
<span class="co">#&gt; [1] "US Midwest"         "US Northeast"       "US Pacific"        </span>
<span class="co">#&gt; [4] "US South"           "US West"            "Georgia (US State)"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"US"</span>, match_by = <span class="st">"iso3166_2"</span>)
<span class="co">#&gt;  [1] "US-AL" "US-AK" "US-AZ" "US-AR" "US-CA" "US-CO" "US-CT" "US-DE" "US-DC"</span>
<span class="co">#&gt; [10] "US-FL" "US-GA" "US-HI" "US-ID" "US-IL" "US-IN" "US-IA" "US-KS" "US-KY"</span>
<span class="co">#&gt; [19] "US-LA" "US-ME" "US-MD" "US-MA" "US-MI" "US-MN" "US-MS" "US-MO" "US-MT"</span>
<span class="co">#&gt; [28] "US-NE" "US-NV" "US-NH" "US-NJ" "US-NM" "US-NY" "US-NC" "US-ND" "US-OH"</span>
<span class="co">#&gt; [37] "US-OK" "US-OR" "US-PA" "US-PR" "US-RI" "US-SC" "US-SD" "US-TN" "US-TX"</span>
<span class="co">#&gt; [46] "US-UT" "US-VT" "US-VA" "US-WA" "US-WV" "US-WI" "US-WY"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"Palestine"</span>)
<span class="co">#&gt; [1] "Israel and Palestine"</span>
<span class="fu"><a href="reference/osmext_check_pattern.html">osmext_check_pattern</a></span>(<span class="st">"Israel"</span>, full_row = <span class="fl">TRUE</span>)
<span class="co">#&gt; Simple feature collection with 1 feature and 14 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 34.07929 ymin: 29.37711 xmax: 35.91531 ymax: 33.35091</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt;                       id                 name parent level iso3166_1_alpha2</span>
<span class="co">#&gt; 151 israel-and-palestine Israel and Palestine   asia     2            PS IL</span>
<span class="co">#&gt;     iso3166_2 pbf_file_size</span>
<span class="co">#&gt; 151      &lt;NA&gt;      82361911</span>
<span class="co">#&gt;                                                                        pbf</span>
<span class="co">#&gt; 151 https://download.geofabrik.de/asia/israel-and-palestine-latest.osm.pbf</span>
<span class="co">#&gt;                                                                        bz2</span>
<span class="co">#&gt; 151 https://download.geofabrik.de/asia/israel-and-palestine-latest.osm.bz2</span>
<span class="co">#&gt;                                                                             shp</span>
<span class="co">#&gt; 151 https://download.geofabrik.de/asia/israel-and-palestine-latest-free.shp.zip</span>
<span class="co">#&gt;                                                                                     pbf.internal</span>
<span class="co">#&gt; 151 https://osm-internal.download.geofabrik.de/asia/israel-and-palestine-latest-internal.osm.pbf</span>
<span class="co">#&gt;                                                                                   history</span>
<span class="co">#&gt; 151 https://osm-internal.download.geofabrik.de/asia/israel-and-palestine-internal.osh.pbf</span>
<span class="co">#&gt;                                                     taginfo</span>
<span class="co">#&gt; 151 https://taginfo.geofabrik.de/asia/israel-and-palestine/</span>
<span class="co">#&gt;                                                             updates</span>
<span class="co">#&gt; 151 https://download.geofabrik.de/asia/israel-and-palestine-updates</span>
<span class="co">#&gt;                           geometry</span>
<span class="co">#&gt; 151 MULTIPOLYGON (((34.64563 32...</span>
</pre></div>
<p>The input <code>place</code> can be also specified using an <code>sfc_POINT</code> object with arbitrary CRS as documented in the following example. If there are multiple matches, the function returns the smallest area (according to the <code>level</code> variable). I would ignore the CRS warning for the moment.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">coords_milan</span> <span class="op">=</span> <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/st.html">st_point</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1514924.21</span>, <span class="fl">5034552.92</span>)) <span class="co"># Duomo di Milano</span>
<span class="kw">st_sfc_milan</span> <span class="op">=</span> <span class="kw">sf</span>::<span class="fu"><a href="https://rdrr.io/pkg/sf/man/sfc.html">st_sfc</a></span>(<span class="kw">coords_milan</span>, crs = <span class="fl">3003</span>)
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="kw">st_sfc_milan</span>)
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/europe/italy/nord-ovest-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 416306623</span>
</pre></div>
<p>The input <code>place</code> can be also specified using a numeric vector of coordinates. In that case the CRS is assumed to be 4326:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">9.1916</span>, <span class="fl">45.4650</span>)) <span class="co"># Duomo di Milano</span>
<span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/europe/italy/nord-ovest-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 416306623</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">9.1916</span>, <span class="fl">45.4650</span>, <span class="fl">9.2020</span>, <span class="fl">45.4781</span>))
<span class="co">#&gt; Error in osmext_match.numeric(c(9.1916, 45.465, 9.202, 45.4781)): You need to provide a pair of coordinates and you passed as input a vector of length 4</span>
<span class="co"># osmext_match(c(9.1916, 45.4650), c(9.2020, 45.4781)) FIXME with suitable check and error</span>
</pre></div>
<p>If there are several error matching the input place with one of the zone, you can also try increasing the maximum allowed string distance:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Isle Wight"</span>)
<span class="co">#&gt; Error: String distance between best match and the input place is 3, while the maximum threshold distance is equal to 1. You should increase the max_string_dist parameter, look for a closer match in the chosen provider database or consider using a different match_by variable.</span>
<span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Isle Wight"</span>, max_string_dist = <span class="fl">3</span>)
<span class="co">#&gt; $url</span>
<span class="co">#&gt; [1] "https://download.geofabrik.de/europe/great-britain/england/isle-of-wight-latest.osm.pbf"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $file_size</span>
<span class="co">#&gt; [1] 6877468</span>
</pre></div>
<div id="test-osmext_download" class="section level2">
<h2 class="hasAnchor">
<a href="#test-osmext_download" class="anchor"></a>Test <code>osmext_download</code>
</h2>
<p>The simplest example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">iow</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_match.html">osmext_match</a></span>(<span class="st">"Isle of Wight"</span>)
<span class="fu"><a href="reference/osmext_download.html">osmext_download</a></span>(
  file_url = <span class="kw">iow</span><span class="op">$</span><span class="kw">url</span>, 
  file_size = <span class="kw">iow</span><span class="op">$</span><span class="kw">file_size</span>
)
<span class="co">#&gt; [1] "/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_isle-of-wight-latest.osm.pbf"</span>
</pre></div>
<p>If you want to download your data into a specific folder once, you can set the download directory:</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span>(<span class="st">"OSMEXT_DOWNLOAD_DIRECTORY"</span> = <span class="st">"/home/andrea/Downloads"</span>)
<span class="fu"><a href="reference/osmext_download.html">osmext_download</a></span>(
  file_url = <span class="kw">iow</span><span class="op">$</span><span class="kw">url</span>, 
  file_size = <span class="kw">iow</span><span class="op">$</span><span class="kw">file_size</span>
)
<span class="co">#&gt; /home/andrea/Downloads/geofabrik_isle-of-wight-latest.osm.pbf</span>
</pre></div>
<p>If you want to set a directory that will persist, you can set <code>OSMEXT_DOWNLOAD_DIRECTORY=/path/for/osm/data</code> in your <code>.Renviron</code> file, e.g. with:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw">usethis</span>::<span class="fu">edit_r_environ</span>()
<span class="co"># Add a line containing: OSMEXT_DOWNLOAD_DIRECTORY=/path/to/save/files</span>
</pre></div>
</div>
<div id="importing-osm-data" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-osm-data" class="anchor"></a>Importing OSM data</h2>
<p>The function <code><a href="reference/osmext_get.html">osmext_get()</a></code> downloads (if not already downloaded) and reads-in data from OSM extract providers as an <code>sf</code> object:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
(<span class="kw">iow</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(<span class="st">"Isle of Wight"</span>, stringsAsFactors = <span class="fl">FALSE</span>))
<span class="co">#&gt; Reading layer `lines' from data source `/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_isle-of-wight-latest.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 44365 features and 9 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -5.401978 ymin: 43.35489 xmax: -0.175775 ymax: 50.89599</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt; Simple feature collection with 44365 features and 9 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -5.401978 ymin: 43.35489 xmax: -0.175775 ymax: 50.89599</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;    osm_id                 name     highway waterway aerialway barrier man_made</span>
<span class="co">#&gt; 1     413             Lane End residential     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 2     415        Foreland Road   secondary     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 3     416          Steyne Road   secondary     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 4     698      Carpenters Road   secondary     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 5     701            Mill Road    tertiary     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 6     705       Downsview Road residential     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 7     706          Lincoln Way residential     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 8     709        Paddock Drive residential     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 9     710 Forelands Field Road residential     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt; 10    713         Howgate Road residential     &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="co">#&gt;    z_order</span>
<span class="co">#&gt; 1        3</span>
<span class="co">#&gt; 2        6</span>
<span class="co">#&gt; 3        6</span>
<span class="co">#&gt; 4        6</span>
<span class="co">#&gt; 5        4</span>
<span class="co">#&gt; 6        3</span>
<span class="co">#&gt; 7        3</span>
<span class="co">#&gt; 8        3</span>
<span class="co">#&gt; 9        3</span>
<span class="co">#&gt; 10       3</span>
<span class="co">#&gt;                                                                                                                 other_tags</span>
<span class="co">#&gt; 1                                                      "lanes"=&gt;"2","lit"=&gt;"yes","maxspeed"=&gt;"30 mph","surface"=&gt;"asphalt"</span>
<span class="co">#&gt; 2                    "lit"=&gt;"yes","ref"=&gt;"B3395","lanes"=&gt;"2","surface"=&gt;"asphalt","maxspeed"=&gt;"30 mph","sidewalk"=&gt;"both"</span>
<span class="co">#&gt; 3                                       "lanes"=&gt;"2","lit"=&gt;"yes","maxspeed"=&gt;"30 mph","ref"=&gt;"B3395","surface"=&gt;"asphalt"</span>
<span class="co">#&gt; 4  "incline"=&gt;"down","lanes"=&gt;"2","lit"=&gt;"yes","maxspeed"=&gt;"30 mph","ref"=&gt;"B3330","sidewalk"=&gt;"left","surface"=&gt;"asphalt"</span>
<span class="co">#&gt; 5                                                       "lanes"=&gt;"2","lit"=&gt;"no","maxspeed"=&gt;"30 mph","surface"=&gt;"asphalt"</span>
<span class="co">#&gt; 6                                                                                                                     &lt;NA&gt;</span>
<span class="co">#&gt; 7                                                                                                                     &lt;NA&gt;</span>
<span class="co">#&gt; 8                                                                                                                     &lt;NA&gt;</span>
<span class="co">#&gt; 9                                                                      "designation"=&gt;"public_footpath","prow_ref"=&gt;"BB13"</span>
<span class="co">#&gt; 10                  "bicycle"=&gt;"yes","foot"=&gt;"yes","horse"=&gt;"yes","maxspeed"=&gt;"30 mph","oneway"=&gt;"no","surface"=&gt;"asphalt"</span>
<span class="co">#&gt;                          geometry</span>
<span class="co">#&gt; 1  LINESTRING (-1.083348 50.68...</span>
<span class="co">#&gt; 2  LINESTRING (-1.083348 50.68...</span>
<span class="co">#&gt; 3  LINESTRING (-1.089935 50.68...</span>
<span class="co">#&gt; 4  LINESTRING (-1.115375 50.69...</span>
<span class="co">#&gt; 5  LINESTRING (-1.094493 50.68...</span>
<span class="co">#&gt; 6  LINESTRING (-1.083304 50.68...</span>
<span class="co">#&gt; 7  LINESTRING (-1.086146 50.68...</span>
<span class="co">#&gt; 8  LINESTRING (-1.074056 50.68...</span>
<span class="co">#&gt; 9  LINESTRING (-1.076458 50.68...</span>
<span class="co">#&gt; 10 LINESTRING (-1.087919 50.68...</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="kw">iow</span>)
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">iow</span>) <span class="co"># default variable names</span>
<span class="co">#&gt;  [1] "osm_id"     "name"       "highway"    "waterway"   "aerialway" </span>
<span class="co">#&gt;  [6] "barrier"    "man_made"   "z_order"    "other_tags" "geometry"</span>
</pre></div>
<p>Once imported, we can use all the functions for data frames in base R and other packages. We can also use functions from the <code>sf</code> package for spatial analysis and visualisation. Let’s plot all the major and minor roads, for example:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="kw">iow_major_roads</span> <span class="op">=</span> <span class="kw">iow</span>[<span class="kw">iow</span><span class="op">$</span><span class="kw">highway</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"primary"</span>, <span class="st">"secondary"</span>), ]
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">iow_major_roads</span>[<span class="st">"highway"</span>])
</pre></div>
<p><img src="reference/figures/README-iow1-1.png" width="100%"></p>
<p>The same steps can be used to get other OSM datasets (note use of <code>osmext_verbose = TRUE</code> to show additional message, examples not run):</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="kw">test_malta</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(<span class="st">"Malta"</span>, osmext_verbose = <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="kw">test_malta</span>)
<span class="kw">test_andorra</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(<span class="st">"Andorra"</span>, extra_attributes = <span class="st">"ref"</span>, osmext_verbose = <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="kw">test_andorra</span>)
</pre></div>
</div>
<div id="queries" class="section level2">
<h2 class="hasAnchor">
<a href="#queries" class="anchor"></a>Queries</h2>
<p>Some files from providers such as geofabrik are large. You may therefore want to check the contents before importing them. To do this you can use an SQL query that is passed to GDAL via <code>sf</code>. To check the values stored in the highway column for our Isle of Wight example, for example, run the following command:</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(
  <span class="st">"Isle of Wight"</span>, 
  query = <span class="st">"SELECT DISTINCT highway FROM \"lines\" "</span>
)
<span class="co">#&gt; Reading layer `lines' from data source `/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_isle-of-wight-latest.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Warning: no simple feature geometries present: returning a data.frame or tbl_df</span>
<span class="co">#&gt;           highway</span>
<span class="co">#&gt; 1     residential</span>
<span class="co">#&gt; 2       secondary</span>
<span class="co">#&gt; 3        tertiary</span>
<span class="co">#&gt; 4    unclassified</span>
<span class="co">#&gt; 5         primary</span>
<span class="co">#&gt; 6         footway</span>
<span class="co">#&gt; 7         service</span>
<span class="co">#&gt; 8            &lt;NA&gt;</span>
<span class="co">#&gt; 9           track</span>
<span class="co">#&gt; 10      bridleway</span>
<span class="co">#&gt; 11          steps</span>
<span class="co">#&gt; 12           path</span>
<span class="co">#&gt; 13   primary_link</span>
<span class="co">#&gt; 14       cycleway</span>
<span class="co">#&gt; 15  living_street</span>
<span class="co">#&gt; 16     pedestrian</span>
<span class="co">#&gt; 17   construction</span>
<span class="co">#&gt; 18 secondary_link</span>
<span class="co">#&gt; 19  tertiary_link</span>
<span class="co">#&gt; 20       proposed</span>
</pre></div>
<p>The values will vary. There are more types of highway in the Andorra dataset, for example:</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(
  <span class="st">"Andorra"</span>, 
  query = <span class="st">"SELECT DISTINCT highway FROM \"lines\" "</span>
)
<span class="co">#&gt; Reading layer `lines' from data source `/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_andorra-latest.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Warning: no simple feature geometries present: returning a data.frame or tbl_df</span>
<span class="co">#&gt;           highway</span>
<span class="co">#&gt; 1         primary</span>
<span class="co">#&gt; 2            &lt;NA&gt;</span>
<span class="co">#&gt; 3           trunk</span>
<span class="co">#&gt; 4  secondary_link</span>
<span class="co">#&gt; 5       secondary</span>
<span class="co">#&gt; 6        tertiary</span>
<span class="co">#&gt; 7     residential</span>
<span class="co">#&gt; 8         service</span>
<span class="co">#&gt; 9           steps</span>
<span class="co">#&gt; 10   unclassified</span>
<span class="co">#&gt; 11     pedestrian</span>
<span class="co">#&gt; 12        footway</span>
<span class="co">#&gt; 13          track</span>
<span class="co">#&gt; 14  living_street</span>
<span class="co">#&gt; 15           path</span>
<span class="co">#&gt; 16      bridleway</span>
<span class="co">#&gt; 17     trunk_link</span>
<span class="co">#&gt; 18   primary_link</span>
<span class="co">#&gt; 19       cycleway</span>
<span class="co">#&gt; 20  tertiary_link</span>
<span class="co">#&gt; 21        raceway</span>
<span class="co">#&gt; 22           road</span>
</pre></div>
<p>The same <code>query</code> argument can be used to read-in only certain features, all primary roads in Andorra for example:</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="co"># and select only one of them: </span>
<span class="kw">iow_primary</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(
  <span class="st">"Isle of Wight"</span>, 
  extra_attributes = <span class="st">"ref"</span>, 
  osmext_verbose = <span class="fl">TRUE</span>, 
  query = <span class="st">"SELECT * FROM 'lines' WHERE highway IN ('primary')"</span>
)
<span class="co">#&gt; The input place was matched with: Isle of Wight</span>
<span class="co">#&gt; The chosen file was already detected in the download directory. Skip downloading.</span>
<span class="co">#&gt; The corresponding gpkg file was already detected. Skip vectortranslate operations</span>
<span class="co">#&gt; Reading layer `lines' from data source `/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_isle-of-wight-latest.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 548 features and 9 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -1.537223 ymin: 50.58314 xmax: -1.141969 ymax: 50.75952</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="kw">iow_primary</span>)
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">iow_primary</span><span class="op">$</span><span class="kw">geometry</span>)
</pre></div>
<p><img src="reference/figures/README-iow2-1.png" width="100%"></p>
<p>This is substantially faster and less memory intensive than reading-in the whole dataset and filtering with R.</p>
<p>You can use <a href="https://gdal.org/user/ogr_sql_dialect.html">GDAL’s SQL syntax</a> to get the result you need. Let’s get all primary and secondary roads, for example:</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="kw">iow_major_roads2</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(
  <span class="st">"Isle of Wight"</span>, 
  extra_attributes = <span class="st">"ref"</span>, 
  osmext_verbose = <span class="fl">TRUE</span>, 
  query = <span class="st">"SELECT * FROM 'lines' WHERE highway IN ('primary', 'secondary')"</span>
)
<span class="co">#&gt; The input place was matched with: Isle of Wight</span>
<span class="co">#&gt; The chosen file was already detected in the download directory. Skip downloading.</span>
<span class="co">#&gt; The corresponding gpkg file was already detected. Skip vectortranslate operations</span>
<span class="co">#&gt; Reading layer `lines' from data source `/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_isle-of-wight-latest.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 918 features and 9 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -1.565827 ymin: 50.58314 xmax: -1.083348 ymax: 50.76245</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">iow_major_roads2</span>[<span class="st">"highway"</span>])
</pre></div>
<p><img src="reference/figures/README-iow3-1.png" width="100%"></p>
<p>You can also use regex, as shown in the following command that gets roads that are likely to be walking and cycling friendly:</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="kw">iow_active_travel</span> <span class="op">=</span> <span class="fu"><a href="reference/osmext_get.html">osmext_get</a></span>(
  <span class="st">"Isle of Wight"</span>, 
  extra_attributes = <span class="st">"ref"</span>, 
  osmext_verbose = <span class="fl">TRUE</span>, 
  query = <span class="st">"SELECT * FROM 'lines' WHERE highway IN ('cycleway', 'living_street')"</span>
)
<span class="co">#&gt; The input place was matched with: Isle of Wight</span>
<span class="co">#&gt; The chosen file was already detected in the download directory. Skip downloading.</span>
<span class="co">#&gt; The corresponding gpkg file was already detected. Skip vectortranslate operations</span>
<span class="co">#&gt; Reading layer `lines' from data source `/mnt/57982e2a-2874-4246-a6fe-115c199bc6bd/data/osm/geofabrik_isle-of-wight-latest.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Simple feature collection with 143 features and 9 fields</span>
<span class="co">#&gt; geometry type:  LINESTRING</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: -1.538843 ymin: 50.61815 xmax: -1.133171 ymax: 50.7592</span>
<span class="co">#&gt; geographic CRS: WGS 84</span>
<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="kw">iow_active_travel</span>[<span class="st">"highway"</span>])
</pre></div>
<p><img src="reference/figures/README-iow4-1.png" width="100%"></p>
</div>
<div id="next-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next steps</h2>
<p>We hope to make the user interface to the SQL syntax more user friendly. Any contributions to support this or any other improvements to the package are very welcome via our issue tracker.</p>
</div>
<div id="licence" class="section level2">
<h2 class="hasAnchor">
<a href="#licence" class="anchor"></a>Licence</h2>
<p>We hope this package will provide easy access to OSM data for reproducible research in the public interest, adhering to the condition of the <a href="https://opendatacommons.org/licenses/odbl/">OdBL licence</a> which states that</p>
<blockquote>
<p>Any Derivative Database that You Publicly Use must be only under the terms of: - i. This License; - ii. A later version of this License similar in spirit to this</p>
</blockquote>
</div>
<div id="other-approaches" class="section level2">
<h2 class="hasAnchor">
<a href="#other-approaches" class="anchor"></a>Other approaches</h2>
<!-- todo: add links to other packages -->
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/itsleeds/osmextractr/">https://​github.com/​itsleeds/​osmextractr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/itsleeds/osmextractr/issues">https://​github.com/​itsleeds/​osmextractr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Robin Lovelace <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5679-6536" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Andrea Gilardi <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-9424-7439" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/itsleeds/osmextractr/actions"><img src="https://github.com/itsleeds/osmextractr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Andrea Gilardi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
